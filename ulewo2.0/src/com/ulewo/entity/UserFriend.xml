<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="userFriend">
	<cacheModel id="user-cache" type="LRU" readOnly="true"
		serialize="false">
		<flushInterval hours="24" />
		<property value="500" name="size" />
	</cacheModel>
	
	<typeAlias alias="friend" type="com.ulewo.entity.UserFriend" />
	
	<!-- 添加-->
	<insert id="addFriend" parameterClass="friend">
		insert into user_friend (userid,friendid,createtime)
		values(#userid#,#friendid#,#createTime#);
	</insert>
	
	<!-- 删除成员 -->
	<delete id="deleteMember" parameterClass="java.util.Map">
		delete from user_friend where userid = #userId# and friendid = #friendId#
	</delete>
	
	
	<!-- 查询关注的人 -->
	<select id="queryFocus" resultClass="friend" parameterClass="java.util.Map">
		select f.friendid as friendId,u.username as friendName,u.userlittleicon as friendIcon from user_friend f inner join user u on f.friendid=u.userid
		where f.userid = #userId# order by createtime desc limit #offset#,#total#
	</select>
	<!-- 查询关注的人数量 -->
	<select id="queryFocusCount" resultClass="java.lang.Integer" parameterClass="java.lang.String">
		select count(*) from user_friend where userid = #userId#
	</select>
	
	<!-- 查询粉丝 -->
	<select id="queryFans" resultClass="java.lang.Integer" parameterClass="java.util.Map">
		select f.userid as friendId,u.username as friendName,u.userlittleicon as friendIcon from user_friend f inner join user u on f.userid=u.userid
		where f.friendid = #userId# order by createtime desc limit #offset#,#total#
	</select>
	<!-- 查询粉丝数量 -->
	<select id="queryFocusCount" resultClass="java.lang.Integer" parameterClass="java.lang.String">
		select count(*) from user_friend where friendid = #userId#
	</select>
</sqlMap>
