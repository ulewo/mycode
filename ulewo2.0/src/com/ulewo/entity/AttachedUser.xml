<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="attachedUser">
	<cacheModel id="user-cache" type="LRU" readOnly="true"
		serialize="false">
		<flushInterval hours="24" />
		<property value="500" name="size" />
	</cacheModel>
	
	
	<typeAlias alias="attachedUser" type="com.ulewo.entity.AttachedUser" />
	
	<!-- 创建 -->
	<insert id="createAttachedUser" parameterClass="attachedUser">
		insert into attached_user(attachedid,userid)
		values(#attachedId#,#userId#)
	</insert>
	
	<!-- 通过userId attachedId查询附件下载的用户 -->
	<select id="queryAttachedUser" resultClass="attachedUser" parameterClass="java.util.Map">
		select * from attached_user where userid = #userId# and attachedid = #attachedId#
	</select>
	
	<select id="queryAttachedUserByAttachedId" resultClass="attachedUser" parameterClass="java.util.Map">
	    select 
	    	a.*,
	    	u.username as userName,
	    	u.userlittleicon as userIcon 
	    from attached_user a inner join user u on u.userid = a.userid 
	    where attachedid = #attachedId#
	</select>
</sqlMap>
