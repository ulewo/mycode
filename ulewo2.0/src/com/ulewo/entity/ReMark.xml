<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="remark">
	<cacheModel id="user-cache" type="LRU" readOnly="true"
		serialize="false">
		<flushInterval hours="24" />
		<property value="500" name="size" />
	</cacheModel>
	
	
	<typeAlias alias="remark" type="com.ulewo.entity.ReMark" />
	
	<!-- 签到 -->
	<insert id="addReMark" parameterClass="remark">
        insert into remark(userid,username,usericon,marktime,markdate) 
		values(#userId#,#userName#,#userIcon#,#markTime#,#markDate#)
	</insert>
	
	<!-- 查询用户当日签到情况 -->
	<select id="queryReMarkByUser" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select count(userid) from remark where userid = #userId# and markdate = #markDate#
	</select>

	<!-- 查询用户签到数量 -->
	<select id="userMarkCount" parameterClass="java.lang.String" resultClass="java.lang.Integer">
		select count(userid) from remark where userid = #userId#
	</select>
	
	<!-- 查询用户签到情况 -->
	<select id="userMarkInfo" parameterClass="java.util.Map" resultClass="remark">
		  select * from remark where userid = #userId#
	    order by marktime desc 
	</select>
	
	<!-- 根据时间查询当日签到情况-->
	<select id="queryReMarkByTime" parameterClass="java.util.Map" resultClass="remark"> 
	    select * from remark where markdate = #markDate#
	    order by marktime 
	</select>
	
	<select id="allMarkCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select count(userid) from remark where markdate = #markDate#
	</select>
	
	<select id="getCountBetweenTime" parameterClass="java.util.Map" resultClass="java.lang.Integer">
		select count(userid) from remark where markdate between #startDate# and #endDate# and userid = #userId#
	</select>
</sqlMap>
